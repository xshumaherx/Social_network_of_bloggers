{% extends 'base.html'%}
{% block title %}
  Последние обновления на сайте
{% endblock %}
{% load thumbnail %}
{% block content %}
  <div class="container py-5">
    <h1>Последние обновления на сайте</h1>
      <form action="{% url "posts:index_search" %}" method="get" onsubmit="return waitToSubmit(event)">
        <input type="text" name="q" value="{{ query|default:'' }}" placeholder="Поиск..."
               title="Введите слово или предложение которое хотите найти в текстах">
        <label for="date_of">Дата от:</label>
        <input type="date" name="date_of" id="date_of" value="{{ date_of|default:'' }}"
               title="Введите дату, от какого числа(включительно)">
        <label for="date_to">до:</label>
        <input type="date" name="date_to" id="date_to" value="{{ date_to|default:'' }}"
               title="Введите дату, до какого числа(включительно)">
        <label for="sort">Сортировать по:</label>
        <select name="sort" id="sort">
          <option value="pub_date" {% if sort == 'pub_date' %}selected{% endif %}>Дате</option>
          <option value="author" {% if sort == 'author' %}selected{% endif %}>Автору</option>
          <option value="titul" {% if sort == 'titul' %}selected{% endif %}>Заголовок</option>
        </select>
        <label for="direction">Направление:</label>
        <select name="direction" id="direction">
          <option value="desc" {% if direction == 'desc' %}selected{% endif %}>По убыванию</option>
          <option value="asc" {% if direction == 'asc' %}selected{% endif %}>По возрастанию</option>
        </select>
        <button type="submit" class="btn btn-primary" id="myButton">Применить</button>
      </form>
      <article>
        {% include 'includes/switcher.html' %}
          {% for post in page_obj %}
            <div class="post-section">
              <ul>
                <li>
                  Автор:
                  <a href="{% url 'posts:profile' post.author.username %}">
                    {{ post.author.get_full_name }}
                  </a>
                </li>
                <li>
                  Дата публикации: {{ post.pub_date|date:"d E Y" }}
                </li>
              </ul>
              <div style="text-align:center;">
                <h1 style="font-size:38px; font-weight:bold; color:#f9fafb;">{{ post.titul }}</h1>
              </div>
            
            <div>
              {% thumbnail post.image "960x339" crop="center" upscale=True as im %}
                <img class="card-img my-2" src="{{ im.url }}">
              {% endthumbnail %}
            </div>
              <p>{{ post.short_text }}</p>
              <a href="{% url 'posts:post_detail' post.pk %}">
                Подробная информация</a>
            </div>
            {% if not forloop.last %}<hr>{% endif %}
            {% endfor %}
          {% include 'includes/paginator.html' %}
        </article>
  </div>
{% endblock %}